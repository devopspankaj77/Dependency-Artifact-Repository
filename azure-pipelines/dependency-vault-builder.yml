trigger:
  branches:
    include:
      - main
      - releases/*
      - feature/*
pr:
  branches:
    include:
      - main
      - releases/*
      - feature/*
parameters:
  - name: nodeVersion
    type: string
    default: '18'
    displayName: 'Node.js Version'

variables:
  artifactName: 'node-vault-$(nodeVersion)'
  storageContainer: 'node-vault'
  storageAccount: '<your-storage-account-name>'

pool: Default
stages:
  - stage: 
    jobs:
      - job: 
        steps:
        - task: NodeTool@0
          inputs:
            versionSource: 'spec'
            versionSpec: '${{ parameters.nodeVersion }}'
        - task: CmdLine@2
          inputs:
            script: |
              cd vault/node$(nodeVersion)
              echo "Installing dependencies..."
              npm ci
              echo "Running audit fix..."
              npm audit fix --force
              echo "Deduping & pruning..."
              npm dedupe
              npm prune --production



  